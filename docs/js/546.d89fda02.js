"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[546,455],{6780:function(t,e,r){r.d(e,{_:function(){return p}});r(560);var a=r(4870),s=r(6797),i=r.n(s),o=r(7400),n=r(2760),l=r(8865),d=r(167);const p=(0,a.Um)({List:localStorage.getItem("approvalList")?JSON.parse(localStorage.getItem("approvalList")):[],template:{index:"",parentIdx:"",parentType:"",update:"",master:"",status:"",writer:""},createApproval(t){if(t.ApprovalLine.length>1)for(let e=0;e<t.ApprovalLine.length;e++){if(0===e){const r={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[e].index,status:"결재요청",writer:t.master,update:i()().format("YYYY-MM-DD")};this.List.push(r),l.j.createAlarm("approvalRequest",r.writer,r.master);continue}const r={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[e].index,status:"대기",writer:t.ApprovalLine[e-1].index,update:i()().format("YYYY-MM-DD")};this.List.push(r)}else{const e={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[0].index,status:"결재요청",writer:t.master,update:i()().format("YYYY-MM-DD")};this.List.push(e)}localStorage.setItem("approvalList",JSON.stringify(this.List))},finishApproval(t){try{const e=this.List.find((e=>e.index===t));if(e.status="결재완료",l.j.createAlarm("approvalApproved",e.master,e.writer),void 0!==this.List.find((t=>e.master===t.writer&&t.parentIdx===e.parentIdx&&t.index!==e.index&&e.index<t.index&&"대기"===t.status))){const t=this.List.find((t=>e.master===t.writer&&t.parentIdx===e.parentIdx&&t.index!==e.index&&e.index<t.index&&"대기"===t.status));t.status="결재요청",t.update=i()().format("YYYY-MM-DD"),l.j.createAlarm("approvalRequest",t.writer,t.master)}else switch(e.parentType){case"project":{let t=o.I.findProjectByIndex(e.parentIdx);t.status="진행",n.m.createWork(t),l.j.createAlarm("projectApproved",e.master,t.master),localStorage.setItem("projectList",JSON.stringify(o.I.List));break}case"work":n.m.finishWork(e.parentIdx,e.desc,e.etc),l.j.createAlarm("workApproved",e.master,e.writer);break;default:console.log("error");break}localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(e){console.log(e)}},callApprovalList(t){return"대기"===t?this.List.filter((e=>e.status===t&&(e.master===d.N.currentMember||e.writer===d.N.currentMember))):this.List.filter((e=>e.status===t&&e.master===d.N.currentMember))},callAllList(){return this.List},findApprovalByIndex(t){return this.List.find((e=>e.index===t&&e.master===d.N.currentMember))},findparentProjectIndexByIndex(t){return this.List.find((e=>e.index===t)).parentIdx},rejectApproval(t){const e=this.List.find((e=>e.index===t));switch(e.parentType){case"project":{let t=o.I.findProjectByIndex(e.parentIdx);t.status="반려",l.j.createAlarm("approvalRejected",e.master,t.master),localStorage.setItem("projectList",JSON.stringify(o.I.List));break}case"work":{let t=n.m.getOriginalWorkByIndex(e.parentIdx);t.status="진행",l.j.createAlarm("workRejected",e.master,t.member),n.m.refreshWorkList();break}default:console.log("error");break}const r=this.List.filter((t=>t.parentIdx===e.parentIdx&&t.index>e.index&&"대기"===t.status));r.forEach((t=>{this.List.splice(this.List.indexOf(t),1)})),this.List.splice(this.List.indexOf(e),1),this.List.forEach(((t,e)=>{t.index=e})),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))},createWorkApproval(t){try{const e=n.m.getWorkByIndex(t[0].index);n.m.getOriginalWorkByIndex(t[0].index).status="결재요청";const r={index:this.List.length,parentIdx:e.index,parentType:"work",title:`${e.member}의 ${e.detail}`,master:e.master,status:"결재요청",writer:e.member,update:i()().format("YYYY-MM-DD"),desc:t[0].desc,etc:t[0].etc};this.List.push(r),n.m.refreshWorkList(),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(e){console.log(e)}},getStatusByParentIdxMember(t,e){const r=this.List.find((r=>r.parentIdx===t&&r.master===e));return r.status},getApprovalByParentIdx(t){return this.List.filter((e=>e.parentIdx===t))}})},7400:function(t,e,r){r.d(e,{I:function(){return n}});r(560);var a=r(4870),s=r(167),i=r(6780),o=r(8865);const n=(0,a.Um)({List:localStorage.getItem("projectList")?JSON.parse(localStorage.getItem("projectList")):[],refreshList(){localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},template:{index:"",title:"",desc:"",start_date:"",end_date:"",master:"",member:[],work:[],status:""},createProject(t){const e={...t,index:this.List.length,master:s.N.currentMember,status:"대기"};this.List.push(e),i._.createApproval(e),e.member.forEach((t=>{t!==s.N.currentMember&&o.j.createAlarm("project",s.N.currentMember,t)})),localStorage.setItem("projectList",JSON.stringify(this.List))},EditProject(t,e){const r=this.findProjectByIndex(t),a=Object.assign(r,e);a.status="대기",i._.createApproval(a),localStorage.setItem("projectList",JSON.stringify(this.List))},callProjectList(t){return this.List.filter((e=>e.status===t))},findProjectByIndex(t){return this.List.find((e=>e.index===t))},deleteProject(t){const e=this.findProjectByIndex(t);e.status="삭제",localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},getProjectByMember(t){return this.List.filter((e=>e.member.includes(t)&&"진행"===e.status))},finishProject(t){const e=this.findProjectByIndex(t);e.status="완료",this.refreshList()},getProjectByMemberAndWork(t,e){return this.List.filter((r=>JSON.stringify(r.member)===JSON.stringify(t)&&JSON.stringify(r.work)===JSON.stringify(e)))}})},2760:function(t,e,r){r.d(e,{m:function(){return l}});r(560);var a=r(4870),s=r(167),i=r(7400),o=r(6797),n=r.n(o);const l=(0,a.Um)({WorkList:localStorage.getItem("workList")?JSON.parse(localStorage.getItem("workList")):[],refreshWorkList(){localStorage.setItem("workList",JSON.stringify(this.WorkList)),this.WorkList=JSON.parse(localStorage.getItem("workList"))},template:{index:"",member:"",master:"",project:"",type:"",deadline:"",update:"",status:"",detail:""},WorkTypeList:[{value:"개발",label:"개발"},{value:"디자인",label:"디자인"},{value:"기획",label:"기획"},{value:"마케팅",label:"마케팅"}],detailWorkTypeList:[{parent:"개발",detailList:["기능 구현","코드 리뷰","테스트","기타"]},{parent:"디자인",detailList:["UI 디자인","UX 디자인","기타"]},{parent:"기획",detailList:["기획","검토","기타"]},{parent:"마케팅",detailList:["영업","홍보","기타"]}],WorkStatusList:[{value:"대기",label:"대기"},{value:"진행",label:"진행"},{value:"완료",label:"완료"},{value:"보류",label:"보류"}],callDetailedWorkByParent(t){let e=[];return this.detailWorkTypeList.forEach((r=>{r.parent===t&&r.detailList.forEach((t=>{e.push({value:t,label:t})}))})),e},indexifyDetail(t){let e="";return this.detailWorkTypeList.forEach((r=>{r.parent===t.department&&r.detailList.forEach(((r,a)=>{r===t.detail&&(e=a)}))})),e},deIndexifyDetailWithMember(t,e){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===t.department&&a.detailList.forEach(((t,a)=>{a===e&&(r=t)}))})),r},deIndexifyDetailWithType(t,e){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===t&&a.detailList.forEach(((t,a)=>{a===e&&(r=t)}))})),r},createWork(t){try{t.member.forEach(((e,r)=>{const a={index:this.WorkList.length,member:e,master:t.master,project:t.index,type:s.N.findMemberByIndex(e).department,detail:t.work[r],deadline:t.end_date,update:n()().format("YYYY-MM-DD"),status:"진행"};this.WorkList.push(a)})),localStorage.setItem("workList",JSON.stringify(this.WorkList))}catch(e){console.log(e)}},getWorkByProjectAndMember(t,e){try{const r=this.WorkList.find((r=>r.project===t.index&&r.member===e)),a={...r};return a.detail=this.deIndexifyDetailWithType(a.type,a.detail),a}catch(r){console.log(r)}},getWorkByProject(t){return this.WorkList.filter((e=>e.project===t))},getWorkByIndex(t){try{const e=this.WorkList.find((e=>e.index===t)),r={...e};return r.detail=this.deIndexifyDetailWithType(r.type,r.detail),r.member=s.N.findMemberByIndex(r.member).name,r.master=s.N.findMemberByIndex(r.master).name,r}catch(e){console.log(e)}},getOriginalWorkByIndex(t){return this.WorkList.find((e=>e.index===t))},getAllWorkByProject(t){return this.WorkList.filter((e=>e.project===t))},finishWork(t,e,r){const a=this.getOriginalWorkByIndex(t);a.status="완료",a.desc=e,a.etc=r,void 0===this.getAllWorkByProject(a.project).find((t=>"완료"!==t.status))&&i.I.finishProject(a.project),this.refreshWorkList()},getWorkByMemberAndDetailAndProject(t,e,r){return this.WorkList.find((a=>a.member===t&&a.detail===e&&a.project===r))}})},8455:function(t,e,r){r.r(e),r.d(e,{default:function(){return l}});var a=r(3396);function s(t,e,r,s,i,o){const n=(0,a.up)("el-input"),l=(0,a.up)("el-date-picker"),d=(0,a.up)("el-form-item"),p=(0,a.up)("el-form"),c=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{model:i.form},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.columns,(t=>((0,a.wg)(),(0,a.j4)(d,{label:t,key:t},{default:(0,a.w5)((()=>["기한"!==t?((0,a.wg)(),(0,a.j4)(n,{key:0,modelValue:i.form[t],"onUpdate:modelValue":e=>i.form[t]=e},null,8,["modelValue","onUpdate:modelValue"])):((0,a.wg)(),(0,a.j4)(l,{key:1,type:"daterange",placeholder:"기한을 입력하세요",modelValue:i.form[t],"onUpdate:modelValue":e=>i.form[t]=e,"range-seperator":"~","start-placeholder":"시작일","end-placeholder":"종료일","value-format":"YYYY-MM-DD",format:"YYYY/MM/DD"},null,8,["modelValue","onUpdate:modelValue"]))])),_:2},1032,["label"])))),128))])),_:1},8,["model"]),(0,a.Wm)(c,{type:"primary",onClick:o.saveForm},{default:(0,a.w5)((()=>[(0,a.Uk)("저장")])),_:1},8,["onClick"])],64)}var i={name:"generalForm",data(){return{form:[]}},emits:["saveForm"],props:{columns:{type:Array,default:()=>[],required:!0},parentData:{type:Object,default:()=>{}}},computed:{formData(){const t={};return this.columns.forEach((e=>{t[e]=""})),t}},methods:{saveForm(){this.$emit("saveForm",this.form)},debug(){console.log(this.form),console.log(this.formData),console.log(this.columns)}},mounted(){this.form=this.formData,this.parentData&&(this.form=this.parentData)}},o=r(89);const n=(0,o.Z)(i,[["render",s]]);var l=n},4546:function(t,e,r){r.r(e),r.d(e,{default:function(){return p}});var a=r(3396);function s(t,e,r,s,i,o){const n=(0,a.up)("el-table-column"),l=(0,a.up)("el-table"),d=(0,a.up)("generalForm");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l,{data:i.tableData,border:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{prop:"type",label:"분야"}),(0,a.Wm)(n,{prop:"detail",label:"업무"}),(0,a.Wm)(n,{prop:"deadline",label:"마감일"}),(0,a.Wm)(n,{prop:"status",label:"상태"})])),_:1},8,["data"]),(0,a.Wm)(d,{columns:i.col,onSaveForm:o.saveProgress},null,8,["columns","onSaveForm"])])}r(560);var i=r(8455),o=r(2760),n={name:"CreateProgress",components:{generalForm:i["default"]},props:{parentWork:{type:Number,required:!0}},data(){return{col:["작업내용","비고"],tableData:[]}},computed:{workData(){return o.m.getWorkByIndex(this.parentWork)}},methods:{tableInit(){this.tableData.push(this.workData)},saveProgress(t){const e=[];e.push({desc:t.작업내용,etc:t.비고,index:this.parentWork}),this.$emit("saveForm",e)}},mounted(){this.tableInit()}},l=r(89);const d=(0,l.Z)(n,[["render",s]]);var p=d}}]);
//# sourceMappingURL=546.d89fda02.js.map