"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[832,606,219,283],{6780:function(e,t,r){r.d(t,{_:function(){return p}});r(560);var a=r(4870),i=r(6797),s=r.n(i),n=r(7400),o=r(2760),l=r(8865),d=r(167);const p=(0,a.Um)({List:localStorage.getItem("approvalList")?JSON.parse(localStorage.getItem("approvalList")):[],template:{index:"",parentIdx:"",parentType:"",update:"",master:"",status:"",writer:""},createApproval(e){if(e.ApprovalLine.length>1)for(let t=0;t<e.ApprovalLine.length;t++){if(0===t){const r={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[t].index,status:"결재요청",writer:e.master,update:s()().format("YYYY-MM-DD")};this.List.push(r),l.j.createAlarm("approvalRequest",r.writer,r.master);continue}const r={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[t].index,status:"대기",writer:e.ApprovalLine[t-1].index,update:s()().format("YYYY-MM-DD")};this.List.push(r)}else{const t={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[0].index,status:"결재요청",writer:e.master,update:s()().format("YYYY-MM-DD")};this.List.push(t)}localStorage.setItem("approvalList",JSON.stringify(this.List))},finishApproval(e){try{const t=this.List.find((t=>t.index===e));if(t.status="결재완료",l.j.createAlarm("approvalApproved",t.master,t.writer),void 0!==this.List.find((e=>t.master===e.writer&&e.parentIdx===t.parentIdx&&e.index!==t.index&&t.index<e.index&&"대기"===e.status))){const e=this.List.find((e=>t.master===e.writer&&e.parentIdx===t.parentIdx&&e.index!==t.index&&t.index<e.index&&"대기"===e.status));e.status="결재요청",e.update=s()().format("YYYY-MM-DD"),l.j.createAlarm("approvalRequest",e.writer,e.master)}else switch(t.parentType){case"project":{let e=n.I.findProjectByIndex(t.parentIdx);e.status="진행",o.m.createWork(e),l.j.createAlarm("projectApproved",t.master,e.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":o.m.finishWork(t.parentIdx,t.desc,t.etc),l.j.createAlarm("workApproved",t.master,t.writer);break;default:console.log("error");break}localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(t){console.log(t)}},callApprovalList(e){return"대기"===e?this.List.filter((t=>t.status===e&&(t.master===d.N.currentMember||t.writer===d.N.currentMember))):this.List.filter((t=>t.status===e&&t.master===d.N.currentMember))},callAllList(){return this.List},findApprovalByIndex(e){return this.List.find((t=>t.index===e&&t.master===d.N.currentMember))},findparentProjectIndexByIndex(e){return this.List.find((t=>t.index===e)).parentIdx},rejectApproval(e){const t=this.List.find((t=>t.index===e));switch(t.parentType){case"project":{let e=n.I.findProjectByIndex(t.parentIdx);e.status="반려",l.j.createAlarm("approvalRejected",t.master,e.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":{let e=o.m.getOriginalWorkByIndex(t.parentIdx);e.status="진행",l.j.createAlarm("workRejected",t.master,e.member),o.m.refreshWorkList();break}default:console.log("error");break}const r=this.List.filter((e=>e.parentIdx===t.parentIdx&&e.index>t.index&&"대기"===e.status));r.forEach((e=>{this.List.splice(this.List.indexOf(e),1)})),this.List.splice(this.List.indexOf(t),1),this.List.forEach(((e,t)=>{e.index=t})),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))},createWorkApproval(e){try{const t=o.m.getWorkByIndex(e[0].index);o.m.getOriginalWorkByIndex(e[0].index).status="결재요청";const r={index:this.List.length,parentIdx:t.index,parentType:"work",title:`${t.member}의 ${t.detail}`,master:t.master,status:"결재요청",writer:t.member,update:s()().format("YYYY-MM-DD"),desc:e[0].desc,etc:e[0].etc};this.List.push(r),o.m.refreshWorkList(),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(t){console.log(t)}},getStatusByParentIdxMember(e,t){const r=this.List.find((r=>r.parentIdx===e&&r.master===t));return r.status},getApprovalByParentIdx(e){return this.List.filter((t=>t.parentIdx===e))}})},7400:function(e,t,r){r.d(t,{I:function(){return o}});r(560);var a=r(4870),i=r(167),s=r(6780),n=r(8865);const o=(0,a.Um)({List:localStorage.getItem("projectList")?JSON.parse(localStorage.getItem("projectList")):[],refreshList(){localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},template:{index:"",title:"",desc:"",start_date:"",end_date:"",master:"",member:[],work:[],status:""},createProject(e){const t={...e,index:this.List.length,master:i.N.currentMember,status:"대기"};this.List.push(t),s._.createApproval(t),t.member.forEach((e=>{e!==i.N.currentMember&&n.j.createAlarm("project",i.N.currentMember,e)})),localStorage.setItem("projectList",JSON.stringify(this.List))},EditProject(e,t){const r=this.findProjectByIndex(e),a=Object.assign(r,t);a.status="대기",s._.createApproval(a),localStorage.setItem("projectList",JSON.stringify(this.List))},callProjectList(e){return this.List.filter((t=>t.status===e))},findProjectByIndex(e){return this.List.find((t=>t.index===e))},deleteProject(e){const t=this.findProjectByIndex(e);t.status="삭제",localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},getProjectByMember(e){return this.List.filter((t=>t.member.includes(e)&&"진행"===t.status))},finishProject(e){const t=this.findProjectByIndex(e);t.status="완료",this.refreshList()},getProjectByMemberAndWork(e,t){return this.List.filter((r=>JSON.stringify(r.member)===JSON.stringify(e)&&JSON.stringify(r.work)===JSON.stringify(t)))}})},2760:function(e,t,r){r.d(t,{m:function(){return l}});r(560);var a=r(4870),i=r(167),s=r(7400),n=r(6797),o=r.n(n);const l=(0,a.Um)({WorkList:localStorage.getItem("workList")?JSON.parse(localStorage.getItem("workList")):[],refreshWorkList(){localStorage.setItem("workList",JSON.stringify(this.WorkList)),this.WorkList=JSON.parse(localStorage.getItem("workList"))},template:{index:"",member:"",master:"",project:"",type:"",deadline:"",update:"",status:"",detail:""},WorkTypeList:[{value:"개발",label:"개발"},{value:"디자인",label:"디자인"},{value:"기획",label:"기획"},{value:"마케팅",label:"마케팅"}],detailWorkTypeList:[{parent:"개발",detailList:["기능 구현","코드 리뷰","테스트","기타"]},{parent:"디자인",detailList:["UI 디자인","UX 디자인","기타"]},{parent:"기획",detailList:["기획","검토","기타"]},{parent:"마케팅",detailList:["영업","홍보","기타"]}],WorkStatusList:[{value:"대기",label:"대기"},{value:"진행",label:"진행"},{value:"완료",label:"완료"},{value:"보류",label:"보류"}],callDetailedWorkByParent(e){let t=[];return this.detailWorkTypeList.forEach((r=>{r.parent===e&&r.detailList.forEach((e=>{t.push({value:e,label:e})}))})),t},indexifyDetail(e){let t="";return this.detailWorkTypeList.forEach((r=>{r.parent===e.department&&r.detailList.forEach(((r,a)=>{r===e.detail&&(t=a)}))})),t},deIndexifyDetailWithMember(e,t){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===e.department&&a.detailList.forEach(((e,a)=>{a===t&&(r=e)}))})),r},deIndexifyDetailWithType(e,t){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===e&&a.detailList.forEach(((e,a)=>{a===t&&(r=e)}))})),r},createWork(e){try{e.member.forEach(((t,r)=>{const a={index:this.WorkList.length,member:t,master:e.master,project:e.index,type:i.N.findMemberByIndex(t).department,detail:e.work[r],deadline:e.end_date,update:o()().format("YYYY-MM-DD"),status:"진행"};this.WorkList.push(a)})),localStorage.setItem("workList",JSON.stringify(this.WorkList))}catch(t){console.log(t)}},getWorkByProjectAndMember(e,t){try{const r=this.WorkList.find((r=>r.project===e.index&&r.member===t)),a={...r};return a.detail=this.deIndexifyDetailWithType(a.type,a.detail),a}catch(r){console.log(r)}},getWorkByProject(e){return this.WorkList.filter((t=>t.project===e))},getWorkByIndex(e){try{const t=this.WorkList.find((t=>t.index===e)),r={...t};return r.detail=this.deIndexifyDetailWithType(r.type,r.detail),r.member=i.N.findMemberByIndex(r.member).name,r.master=i.N.findMemberByIndex(r.master).name,r}catch(t){console.log(t)}},getOriginalWorkByIndex(e){return this.WorkList.find((t=>t.index===e))},getAllWorkByProject(e){return this.WorkList.filter((t=>t.project===e))},finishWork(e,t,r){const a=this.getOriginalWorkByIndex(e);a.status="완료",a.desc=t,a.etc=r,void 0===this.getAllWorkByProject(a.project).find((e=>"완료"!==e.status))&&s.I.finishProject(a.project),this.refreshWorkList()},getWorkByMemberAndDetailAndProject(e,t,r){return this.WorkList.find((a=>a.member===e&&a.detail===t&&a.project===r))}})},2832:function(e,t,r){r.r(t),r.d(t,{default:function(){return L}});var a=r(3396),i=r(7139);const s={key:0},n={key:1},o={key:0},l={class:"rightSideButtons"};function d(e,t,r,d,p,c){const u=(0,a.up)("el-switch"),m=(0,a.up)("memberTree"),h=(0,a.up)("el-tab-pane"),f=(0,a.up)("checkBoxGroup"),g=(0,a.up)("el-tabs"),k=(0,a.up)("el-col"),L=(0,a.up)("memberTable"),x=(0,a.up)("el-row"),y=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(u,{modelValue:p.isGroup,"onUpdate:modelValue":t[0]||(t[0]=e=>p.isGroup=e),"active-text":"단체","inactive-text":"개인"},null,8,["modelValue"]),p.isGroup?((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(x,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{type:"border-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{label:"개인"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{onOnNodeClick:c.addGroup},null,8,["onOnNodeClick"])])),_:1}),(0,a.Wm)(h,{label:"그룹"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{parentData:p.GroupedData,onGroupSave:c.takeGroup},null,8,["parentData","onGroupSave"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(k,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{parentData:p.GroupData},null,8,["parentData"])])),_:1})])),_:1}),(0,a.Uk)(" "+(0,i.zw)(p.GroupData),1)])):((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(m,{onOnNodeClick:c.addSingle},null,8,["onOnNodeClick"]),p.SingleData.name?((0,a.wg)(),(0,a.iD)("span",o,"선택된 사람: "+(0,i.zw)(p.SingleData.name)+"("+(0,i.zw)(p.SingleData.department)+")",1)):(0,a.kq)("",!0)])),(0,a._)("div",l,[(0,a.Wm)(y,{type:"primary",onClick:c.saveMember},{default:(0,a.w5)((()=>[(0,a.Uk)("저장")])),_:1},8,["onClick"]),(0,a.Wm)(y,{onClick:c.reset},{default:(0,a.w5)((()=>[(0,a.Uk)("초기화")])),_:1},8,["onClick"])])])}r(560);var p=r(3283),c=r(3219),u=r(4606),m=r(167),h=r(7178),f={name:"assignMember",components:{memberTree:p["default"],memberTable:c["default"],checkBoxGroup:u["default"]},props:{where:{type:String,default:"to"}},data(){return{isGroup:!1,SingleData:{},GroupData:[],GroupedData:[],CurrentMember:m.N.currentMember}},methods:{addGroup(e){this.GroupData.includes(e.index)||this.GroupData.push(e.index)},addSingle(e){e.index!==this.CurrentMember?this.SingleData=e:h.z8.error("본인에게 메세지를 보낼 수 없습니다")},takeGroup(e){this.GroupedData=e},reset(){this.GroupData=[],this.GroupedData=[],this.SingleData={}},saveMember(){let e=null;if(this.isGroup){if(h.z8.info("본인이 배정되었다면 자동으로 제외됩니다."),e=this.GroupData.filter((e=>e!==this.CurrentMember)),0===e.length)return void h.z8.error("본인만 배정되어 배정이 취소됩니다. 다시 배정해주세요")}else e=this.SingleData.index;if(0===e.length)return h.z8.error("배정된 사람이 없거나 본인만 배정되어 있습니다. 다시배정해주세요."),void this.reset();this.$emit("saveMember",e,this.where)}},watch:{GroupedData(){this.GroupData=[],this.GroupedData.forEach((e=>{let t=m.N.getMemberByDepartment(e);t.forEach((e=>{this.GroupData.includes(e)||this.GroupData.push(e)}))}))}}},g=r(89);const k=(0,g.Z)(f,[["render",d]]);var L=k},4606:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var a=r(3396),i=r(7139);function s(e,t,r,s,n,o){const l=(0,a.up)("el-alert"),d=(0,a.up)("el-checkbox-button"),p=(0,a.up)("el-checkbox-group");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l,{type:"info",title:"참고","show-icon":"",closable:!1},{default:(0,a.w5)((()=>[(0,a.Uk)("본인이 포함된 그룹을 선택시 자동으로 본인을 제외합니다.")])),_:1}),(0,a.Wm)(p,{modelValue:n.checked,"onUpdate:modelValue":t[0]||(t[0]=e=>n.checked=e)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.Groups,(e=>((0,a.wg)(),(0,a.j4)(d,{key:e,label:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])}var n={name:"checkBoxGroup",props:{parentData:{type:Array}},data(){return{checked:[],Groups:["개발","디자인","기획","마케팅"]}},watch:{parentData(){this.checked=this.parentData},checked(){this.$emit("groupSave",this.checked)}}},o=r(89);const l=(0,o.Z)(n,[["render",s]]);var d=l},3219:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var a=r(3396);function i(e,t,r,i,s,n){const o=(0,a.up)("el-table-column"),l=(0,a.up)("el-table");return(0,a.wg)(),(0,a.j4)(l,{data:n.memberData,border:""},{default:(0,a.w5)((()=>[r.ApprovalCheck?((0,a.wg)(),(0,a.j4)(o,{key:0,type:"index"})):(0,a.kq)("",!0),(0,a.Wm)(o,{prop:"name",label:"이름"}),(0,a.Wm)(o,{prop:"department",label:"분야"}),(0,a.Wm)(o,{prop:"rank",label:"직급"}),r.ApprovalCheck&&null!==r.parentIdx?((0,a.wg)(),(0,a.j4)(o,{key:1,prop:"status",label:"상태"})):(0,a.kq)("",!0)])),_:1},8,["data"])}r(560);var s=r(167),n=r(6780),o={name:"memberTable",data(){return{tableData:[]}},props:{parentData:{type:Array,default:()=>[],required:!0},ApprovalCheck:{type:Boolean,default:!1},parentIdx:{type:Number,default:null}},computed:{memberData(){if(this.ApprovalCheck){const e=[];return this.parentData.forEach((t=>{let r=s.N.findMemberByIndex(t.index);e[t.order]=r,!e[t.order].status&&null!==this.parentIdx&&n._.getStatusByParentIdxMember(this.parentIdx,t.index)&&(e[t.order].status=n._.getStatusByParentIdxMember(this.parentIdx,t.index))})),e}{const e=[];return this.parentData.forEach((t=>{e.push(s.N.findMemberByIndex(t))})),e}}}},l=r(89);const d=(0,l.Z)(o,[["render",i]]);var p=d},3283:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var a=r(3396);function i(e,t,r,i,s,n){const o=(0,a.up)("el-tree"),l=(0,a.up)("el-card");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l,{shadow:"never"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{ref:"tree",data:n.memberData,onNodeClick:n.onNodeClick,"node-key":"key"},null,8,["data","onNodeClick"])])),_:1})])}var s=r(167),n={name:"MemberTree",emits:["onNodeClick"],data(){return{checked:[],indeterminate:[]}},props:{currentCheck:{type:Array,default:()=>[]}},computed:{memberData(){return s.N.CallTeamTree()},isClear(){return void 0!==this.currentCheck[0]&&this.$refs.tree.getCurrentKey()===this.currentCheck[0].index}},methods:{onNodeClick(e){e.children||(this.$refs.tree.setCurrentKey(e.key),this.$emit("onNodeClick",s.N.findMemberByIndex(e.key)))},clearHighlight(){this.isClear||this.$refs.tree.setCurrentkey([],!1)}}},o=r(89);const l=(0,o.Z)(n,[["render",i]]);var d=l}}]);
//# sourceMappingURL=832.a2cbc6d1.js.map