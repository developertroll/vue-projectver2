"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[837,500,219],{6780:function(e,t,r){r.d(t,{_:function(){return p}});r(560);var a=r(4870),i=r(6797),s=r.n(i),n=r(7400),o=r(2760),l=r(8865),d=r(167);const p=(0,a.Um)({List:localStorage.getItem("approvalList")?JSON.parse(localStorage.getItem("approvalList")):[],template:{index:"",parentIdx:"",parentType:"",update:"",master:"",status:"",writer:""},createApproval(e){if(e.ApprovalLine.length>1)for(let t=0;t<e.ApprovalLine.length;t++){if(0===t){const r={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[t].index,status:"결재요청",writer:e.master,update:s()().format("YYYY-MM-DD")};this.List.push(r),l.j.createAlarm("approvalRequest",r.writer,r.master);continue}const r={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[t].index,status:"대기",writer:e.ApprovalLine[t-1].index,update:s()().format("YYYY-MM-DD")};this.List.push(r)}else{const t={index:this.List.length,parentIdx:e.index,parentType:"project",title:e.title,master:e.ApprovalLine[0].index,status:"결재요청",writer:e.master,update:s()().format("YYYY-MM-DD")};this.List.push(t)}localStorage.setItem("approvalList",JSON.stringify(this.List))},finishApproval(e){try{const t=this.List.find((t=>t.index===e));if(t.status="결재완료",l.j.createAlarm("approvalApproved",t.master,t.writer),void 0!==this.List.find((e=>t.master===e.writer&&e.parentIdx===t.parentIdx&&e.index!==t.index&&t.index<e.index&&"대기"===e.status))){const e=this.List.find((e=>t.master===e.writer&&e.parentIdx===t.parentIdx&&e.index!==t.index&&t.index<e.index&&"대기"===e.status));e.status="결재요청",e.update=s()().format("YYYY-MM-DD"),l.j.createAlarm("approvalRequest",e.writer,e.master)}else switch(t.parentType){case"project":{let e=n.I.findProjectByIndex(t.parentIdx);e.status="진행",o.m.createWork(e),l.j.createAlarm("projectApproved",t.master,e.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":o.m.finishWork(t.parentIdx,t.desc,t.etc),l.j.createAlarm("workApproved",t.master,t.writer);break;default:console.log("error");break}localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(t){console.log(t)}},callApprovalList(e){return"대기"===e?this.List.filter((t=>t.status===e&&(t.master===d.N.currentMember||t.writer===d.N.currentMember))):this.List.filter((t=>t.status===e&&t.master===d.N.currentMember))},callAllList(){return this.List},findApprovalByIndex(e){return this.List.find((t=>t.index===e&&t.master===d.N.currentMember))},findparentProjectIndexByIndex(e){return this.List.find((t=>t.index===e)).parentIdx},rejectApproval(e){const t=this.List.find((t=>t.index===e));switch(t.parentType){case"project":{let e=n.I.findProjectByIndex(t.parentIdx);e.status="반려",l.j.createAlarm("approvalRejected",t.master,e.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":{let e=o.m.getOriginalWorkByIndex(t.parentIdx);e.status="진행",l.j.createAlarm("workRejected",t.master,e.member),o.m.refreshWorkList();break}default:console.log("error");break}const r=this.List.filter((e=>e.parentIdx===t.parentIdx&&e.index>t.index&&"대기"===e.status));r.forEach((e=>{this.List.splice(this.List.indexOf(e),1)})),this.List.splice(this.List.indexOf(t),1),this.List.forEach(((e,t)=>{e.index=t})),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))},createWorkApproval(e){try{const t=o.m.getWorkByIndex(e[0].index);o.m.getOriginalWorkByIndex(e[0].index).status="결재요청";const r={index:this.List.length,parentIdx:t.index,parentType:"work",title:`${t.member}의 ${t.detail}`,master:t.master,status:"결재요청",writer:t.member,update:s()().format("YYYY-MM-DD"),desc:e[0].desc,etc:e[0].etc};this.List.push(r),o.m.refreshWorkList(),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(t){console.log(t)}},getStatusByParentIdxMember(e,t){const r=this.List.find((r=>r.parentIdx===e&&r.master===t));return r.status},getApprovalByParentIdx(e){return this.List.filter((t=>t.parentIdx===e))}})},7400:function(e,t,r){r.d(t,{I:function(){return o}});r(560);var a=r(4870),i=r(167),s=r(6780),n=r(8865);const o=(0,a.Um)({List:localStorage.getItem("projectList")?JSON.parse(localStorage.getItem("projectList")):[],refreshList(){localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},template:{index:"",title:"",desc:"",start_date:"",end_date:"",master:"",member:[],work:[],status:""},createProject(e){const t={...e,index:this.List.length,master:i.N.currentMember,status:"대기"};this.List.push(t),s._.createApproval(t),t.member.forEach((e=>{e!==i.N.currentMember&&n.j.createAlarm("project",i.N.currentMember,e)})),localStorage.setItem("projectList",JSON.stringify(this.List))},EditProject(e,t){const r=this.findProjectByIndex(e),a=Object.assign(r,t);a.status="대기",s._.createApproval(a),localStorage.setItem("projectList",JSON.stringify(this.List))},callProjectList(e){return this.List.filter((t=>t.status===e))},findProjectByIndex(e){return this.List.find((t=>t.index===e))},deleteProject(e){const t=this.findProjectByIndex(e);t.status="삭제",localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},getProjectByMember(e){return this.List.filter((t=>t.member.includes(e)&&"진행"===t.status))},finishProject(e){const t=this.findProjectByIndex(e);t.status="완료",this.refreshList()},getProjectByMemberAndWork(e,t){return this.List.filter((r=>JSON.stringify(r.member)===JSON.stringify(e)&&JSON.stringify(r.work)===JSON.stringify(t)))}})},2760:function(e,t,r){r.d(t,{m:function(){return l}});r(560);var a=r(4870),i=r(167),s=r(7400),n=r(6797),o=r.n(n);const l=(0,a.Um)({WorkList:localStorage.getItem("workList")?JSON.parse(localStorage.getItem("workList")):[],refreshWorkList(){localStorage.setItem("workList",JSON.stringify(this.WorkList)),this.WorkList=JSON.parse(localStorage.getItem("workList"))},template:{index:"",member:"",master:"",project:"",type:"",deadline:"",update:"",status:"",detail:""},WorkTypeList:[{value:"개발",label:"개발"},{value:"디자인",label:"디자인"},{value:"기획",label:"기획"},{value:"마케팅",label:"마케팅"}],detailWorkTypeList:[{parent:"개발",detailList:["기능 구현","코드 리뷰","테스트","기타"]},{parent:"디자인",detailList:["UI 디자인","UX 디자인","기타"]},{parent:"기획",detailList:["기획","검토","기타"]},{parent:"마케팅",detailList:["영업","홍보","기타"]}],WorkStatusList:[{value:"대기",label:"대기"},{value:"진행",label:"진행"},{value:"완료",label:"완료"},{value:"보류",label:"보류"}],callDetailedWorkByParent(e){let t=[];return this.detailWorkTypeList.forEach((r=>{r.parent===e&&r.detailList.forEach((e=>{t.push({value:e,label:e})}))})),t},indexifyDetail(e){let t="";return this.detailWorkTypeList.forEach((r=>{r.parent===e.department&&r.detailList.forEach(((r,a)=>{r===e.detail&&(t=a)}))})),t},deIndexifyDetailWithMember(e,t){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===e.department&&a.detailList.forEach(((e,a)=>{a===t&&(r=e)}))})),r},deIndexifyDetailWithType(e,t){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===e&&a.detailList.forEach(((e,a)=>{a===t&&(r=e)}))})),r},createWork(e){try{e.member.forEach(((t,r)=>{const a={index:this.WorkList.length,member:t,master:e.master,project:e.index,type:i.N.findMemberByIndex(t).department,detail:e.work[r],deadline:e.end_date,update:o()().format("YYYY-MM-DD"),status:"진행"};this.WorkList.push(a)})),localStorage.setItem("workList",JSON.stringify(this.WorkList))}catch(t){console.log(t)}},getWorkByProjectAndMember(e,t){try{const r=this.WorkList.find((r=>r.project===e.index&&r.member===t)),a={...r};return a.detail=this.deIndexifyDetailWithType(a.type,a.detail),a}catch(r){console.log(r)}},getWorkByProject(e){return this.WorkList.filter((t=>t.project===e))},getWorkByIndex(e){try{const t=this.WorkList.find((t=>t.index===e)),r={...t};return r.detail=this.deIndexifyDetailWithType(r.type,r.detail),r.member=i.N.findMemberByIndex(r.member).name,r.master=i.N.findMemberByIndex(r.master).name,r}catch(t){console.log(t)}},getOriginalWorkByIndex(e){return this.WorkList.find((t=>t.index===e))},getAllWorkByProject(e){return this.WorkList.filter((t=>t.project===e))},finishWork(e,t,r){const a=this.getOriginalWorkByIndex(e);a.status="완료",a.desc=t,a.etc=r,void 0===this.getAllWorkByProject(a.project).find((e=>"완료"!==e.status))&&s.I.finishProject(a.project),this.refreshWorkList()},getWorkByMemberAndDetailAndProject(e,t,r){return this.WorkList.find((a=>a.member===e&&a.detail===t&&a.project===r))}})},2985:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var a=r(3396);function i(e,t,r,i,s,n){const o=(0,a.up)("el-table-column"),l=(0,a.up)("el-table");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l,{data:s.tableData,border:""},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{prop:"name",label:"이름"}),(0,a.Wm)(o,{prop:"department",label:"분야"}),(0,a.Wm)(o,{prop:"detail",label:"업무"}),n.approvedCheck?((0,a.wg)(),(0,a.j4)(o,{key:0,prop:"status",label:"상태"})):(0,a.kq)("",!0)])),_:1},8,["data"])])}r(560);var s=r(2760),n=r(167),o={name:"WorkTable",data(){return{tableData:[]}},props:{parentProject:{type:Number,default:null},parentWork:{type:Array,default:()=>[],required:!0},parentMember:{type:Array,default:()=>[],required:!0}},computed:{memberData(){const e=[];return this.parentMember.forEach((t=>{e.push(n.N.findMemberByIndex(t))})),e},approvedCheck(){return s.m.getWorkByProject(this.parentProject).length>0}},methods:{WorkData(){const e=[],t=[];this.memberData.forEach(((r,a)=>{e.push({...r,detail:this.parentWork[a]}),t.push(s.m.getWorkByMemberAndDetailAndProject(this.parentMember[a],this.parentWork[a],this.parentProject)?s.m.getWorkByMemberAndDetailAndProject(this.parentMember[a],this.parentWork[a],this.parentProject).status:null)})),e.forEach(((e,r)=>{this.tableData.push({name:e.name,department:e.department,detail:s.m.deIndexifyDetailWithMember(e,e.detail),referenceIndex:e.index,status:null===this.parentProject?null:t[r]})}))}},mounted(){this.WorkData()}},l=r(89);const d=(0,l.Z)(o,[["render",i]]);var p=d},3219:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var a=r(3396);function i(e,t,r,i,s,n){const o=(0,a.up)("el-table-column"),l=(0,a.up)("el-table");return(0,a.wg)(),(0,a.j4)(l,{data:n.memberData,border:""},{default:(0,a.w5)((()=>[r.ApprovalCheck?((0,a.wg)(),(0,a.j4)(o,{key:0,type:"index"})):(0,a.kq)("",!0),(0,a.Wm)(o,{prop:"name",label:"이름"}),(0,a.Wm)(o,{prop:"department",label:"분야"}),(0,a.Wm)(o,{prop:"rank",label:"직급"}),r.ApprovalCheck&&null!==r.parentIdx?((0,a.wg)(),(0,a.j4)(o,{key:1,prop:"status",label:"상태"})):(0,a.kq)("",!0)])),_:1},8,["data"])}r(560);var s=r(167),n=r(6780),o={name:"memberTable",data(){return{tableData:[]}},props:{parentData:{type:Array,default:()=>[],required:!0},ApprovalCheck:{type:Boolean,default:!1},parentIdx:{type:Number,default:null}},computed:{memberData(){if(this.ApprovalCheck){const e=[];return this.parentData.forEach((t=>{let r=s.N.findMemberByIndex(t.index);e[t.order]=r,!e[t.order].status&&null!==this.parentIdx&&n._.getStatusByParentIdxMember(this.parentIdx,t.index)&&(e[t.order].status=n._.getStatusByParentIdxMember(this.parentIdx,t.index))})),e}{const e=[];return this.parentData.forEach((t=>{e.push(s.N.findMemberByIndex(t))})),e}}}},l=r(89);const d=(0,l.Z)(o,[["render",i]]);var p=d},5837:function(e,t,r){r.r(t),r.d(t,{default:function(){return L}});var a=r(3396),i=r(7139);const s={key:0,class:"borderBox"},n={key:1,class:"borderBox"},o={key:2,class:"borderBox"},l={key:3,class:"borderBox"};function d(e,t,r,d,p,c){const m=(0,a.up)("el-divider"),u=(0,a.up)("memberTable"),h=(0,a.up)("WorkTable");return(0,a.wg)(),(0,a.iD)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.project,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a.Wm)(m,{"content-position":"left"},{default:(0,a.w5)((()=>[(0,a._)("h2",null,(0,i.zw)(p.translateKey[t]),1)])),_:2},1024),"member"===t?((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(u,{parentData:e},null,8,["parentData"])])):"ApprovalLine"===t?((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(u,{parentData:e,ApprovalCheck:!0,parentIdx:r.projectIndex},null,8,["parentData","parentIdx"])])):"work"===t?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(h,{parentMember:p.project.member,parentWork:e,parentProject:r.projectIndex},null,8,["parentMember","parentWork","parentProject"])])):((0,a.wg)(),(0,a.iD)("div",l,(0,i.zw)(e),1))])))),128))])}var p=r(3219),c=r(2985),m=r(7400),u=r(167),h={name:"showProject",components:{memberTable:p["default"],WorkTable:c["default"]},props:{isSaved:{type:Boolean,default:!0},projectData:{type:Object,default:()=>({})},projectIndex:{type:Number,default:null}},data(){return{project:this.isSaved?{}:this.projectData,translateKey:{title:"프로젝트 이름",desc:"설명",start_date:"시작일",end_date:"종료일",member:"참여 인원",ApprovalLine:"결재 라인",work:"업무",master:"작성자",status:"상태"},index:null}},methods:{findSavedByIndex(){if(this.isSaved){const e=m.I.findProjectByIndex(this.projectIndex),{index:t,...r}=e;this.index=t,r.master=u.N.findMemberByIndex(r.master).name,this.project=r}}},created(){this.findSavedByIndex()}},f=r(89);const x=(0,f.Z)(h,[["render",d]]);var L=x}}]);
//# sourceMappingURL=837.f8ddc067.js.map