"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[973],{6780:function(t,e,r){r.d(e,{_:function(){return p}});r(560);var a=r(4870),i=r(6797),s=r.n(i),n=r(7400),l=r(2760),o=r(8865),d=r(167);const p=(0,a.Um)({List:localStorage.getItem("approvalList")?JSON.parse(localStorage.getItem("approvalList")):[],template:{index:"",parentIdx:"",parentType:"",update:"",master:"",status:"",writer:""},createApproval(t){if(t.ApprovalLine.length>1)for(let e=0;e<t.ApprovalLine.length;e++){if(0===e){const r={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[e].index,status:"결재요청",writer:t.master,update:s()().format("YYYY-MM-DD")};this.List.push(r),o.j.createAlarm("approvalRequest",r.writer,r.master);continue}const r={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[e].index,status:"대기",writer:t.ApprovalLine[e-1].index,update:s()().format("YYYY-MM-DD")};this.List.push(r)}else{const e={index:this.List.length,parentIdx:t.index,parentType:"project",title:t.title,master:t.ApprovalLine[0].index,status:"결재요청",writer:t.master,update:s()().format("YYYY-MM-DD")};this.List.push(e)}localStorage.setItem("approvalList",JSON.stringify(this.List))},finishApproval(t){try{const e=this.List.find((e=>e.index===t));if(e.status="결재완료",o.j.createAlarm("approvalApproved",e.master,e.writer),void 0!==this.List.find((t=>e.master===t.writer&&t.parentIdx===e.parentIdx&&t.index!==e.index&&e.index<t.index&&"대기"===t.status))){const t=this.List.find((t=>e.master===t.writer&&t.parentIdx===e.parentIdx&&t.index!==e.index&&e.index<t.index&&"대기"===t.status));t.status="결재요청",t.update=s()().format("YYYY-MM-DD"),o.j.createAlarm("approvalRequest",t.writer,t.master)}else switch(e.parentType){case"project":{let t=n.I.findProjectByIndex(e.parentIdx);t.status="진행",l.m.createWork(t),o.j.createAlarm("projectApproved",e.master,t.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":l.m.finishWork(e.parentIdx,e.desc,e.etc),o.j.createAlarm("workApproved",e.master,e.writer);break;default:console.log("error");break}localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(e){console.log(e)}},callApprovalList(t){return"대기"===t?this.List.filter((e=>e.status===t&&(e.master===d.N.currentMember||e.writer===d.N.currentMember))):this.List.filter((e=>e.status===t&&e.master===d.N.currentMember))},callAllList(){return this.List},findApprovalByIndex(t){return this.List.find((e=>e.index===t&&e.master===d.N.currentMember))},findparentProjectIndexByIndex(t){return this.List.find((e=>e.index===t)).parentIdx},rejectApproval(t){const e=this.List.find((e=>e.index===t));switch(e.parentType){case"project":{let t=n.I.findProjectByIndex(e.parentIdx);t.status="반려",o.j.createAlarm("approvalRejected",e.master,t.master),localStorage.setItem("projectList",JSON.stringify(n.I.List));break}case"work":{let t=l.m.getOriginalWorkByIndex(e.parentIdx);t.status="진행",o.j.createAlarm("workRejected",e.master,t.member),l.m.refreshWorkList();break}default:console.log("error");break}const r=this.List.filter((t=>t.parentIdx===e.parentIdx&&t.index>e.index&&"대기"===t.status));r.forEach((t=>{this.List.splice(this.List.indexOf(t),1)})),this.List.splice(this.List.indexOf(e),1),this.List.forEach(((t,e)=>{t.index=e})),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))},createWorkApproval(t){try{const e=l.m.getWorkByIndex(t[0].index);l.m.getOriginalWorkByIndex(t[0].index).status="결재요청";const r={index:this.List.length,parentIdx:e.index,parentType:"work",title:`${e.member}의 ${e.detail}`,master:e.master,status:"결재요청",writer:e.member,update:s()().format("YYYY-MM-DD"),desc:t[0].desc,etc:t[0].etc};this.List.push(r),l.m.refreshWorkList(),localStorage.setItem("approvalList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("approvalList"))}catch(e){console.log(e)}},getStatusByParentIdxMember(t,e){const r=this.List.find((r=>r.parentIdx===t&&r.master===e));return r.status},getApprovalByParentIdx(t){return this.List.filter((e=>e.parentIdx===t))}})},7400:function(t,e,r){r.d(e,{I:function(){return l}});r(560);var a=r(4870),i=r(167),s=r(6780),n=r(8865);const l=(0,a.Um)({List:localStorage.getItem("projectList")?JSON.parse(localStorage.getItem("projectList")):[],refreshList(){localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},template:{index:"",title:"",desc:"",start_date:"",end_date:"",master:"",member:[],work:[],status:""},createProject(t){const e={...t,index:this.List.length,master:i.N.currentMember,status:"대기"};this.List.push(e),s._.createApproval(e),e.member.forEach((t=>{t!==i.N.currentMember&&n.j.createAlarm("project",i.N.currentMember,t)})),localStorage.setItem("projectList",JSON.stringify(this.List))},EditProject(t,e){const r=this.findProjectByIndex(t),a=Object.assign(r,e);a.status="대기",s._.createApproval(a),localStorage.setItem("projectList",JSON.stringify(this.List))},callProjectList(t){return this.List.filter((e=>e.status===t))},findProjectByIndex(t){return this.List.find((e=>e.index===t))},deleteProject(t){const e=this.findProjectByIndex(t);e.status="삭제",localStorage.setItem("projectList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("projectList"))},getProjectByMember(t){return this.List.filter((e=>e.member.includes(t)&&"진행"===e.status))},finishProject(t){const e=this.findProjectByIndex(t);e.status="완료",this.refreshList()},getProjectByMemberAndWork(t,e){return this.List.filter((r=>JSON.stringify(r.member)===JSON.stringify(t)&&JSON.stringify(r.work)===JSON.stringify(e)))}})},2760:function(t,e,r){r.d(e,{m:function(){return o}});r(560);var a=r(4870),i=r(167),s=r(7400),n=r(6797),l=r.n(n);const o=(0,a.Um)({WorkList:localStorage.getItem("workList")?JSON.parse(localStorage.getItem("workList")):[],refreshWorkList(){localStorage.setItem("workList",JSON.stringify(this.WorkList)),this.WorkList=JSON.parse(localStorage.getItem("workList"))},template:{index:"",member:"",master:"",project:"",type:"",deadline:"",update:"",status:"",detail:""},WorkTypeList:[{value:"개발",label:"개발"},{value:"디자인",label:"디자인"},{value:"기획",label:"기획"},{value:"마케팅",label:"마케팅"}],detailWorkTypeList:[{parent:"개발",detailList:["기능 구현","코드 리뷰","테스트","기타"]},{parent:"디자인",detailList:["UI 디자인","UX 디자인","기타"]},{parent:"기획",detailList:["기획","검토","기타"]},{parent:"마케팅",detailList:["영업","홍보","기타"]}],WorkStatusList:[{value:"대기",label:"대기"},{value:"진행",label:"진행"},{value:"완료",label:"완료"},{value:"보류",label:"보류"}],callDetailedWorkByParent(t){let e=[];return this.detailWorkTypeList.forEach((r=>{r.parent===t&&r.detailList.forEach((t=>{e.push({value:t,label:t})}))})),e},indexifyDetail(t){let e="";return this.detailWorkTypeList.forEach((r=>{r.parent===t.department&&r.detailList.forEach(((r,a)=>{r===t.detail&&(e=a)}))})),e},deIndexifyDetailWithMember(t,e){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===t.department&&a.detailList.forEach(((t,a)=>{a===e&&(r=t)}))})),r},deIndexifyDetailWithType(t,e){let r="";return this.detailWorkTypeList.forEach((a=>{a.parent===t&&a.detailList.forEach(((t,a)=>{a===e&&(r=t)}))})),r},createWork(t){try{t.member.forEach(((e,r)=>{const a={index:this.WorkList.length,member:e,master:t.master,project:t.index,type:i.N.findMemberByIndex(e).department,detail:t.work[r],deadline:t.end_date,update:l()().format("YYYY-MM-DD"),status:"진행"};this.WorkList.push(a)})),localStorage.setItem("workList",JSON.stringify(this.WorkList))}catch(e){console.log(e)}},getWorkByProjectAndMember(t,e){try{const r=this.WorkList.find((r=>r.project===t.index&&r.member===e)),a={...r};return a.detail=this.deIndexifyDetailWithType(a.type,a.detail),a}catch(r){console.log(r)}},getWorkByProject(t){return this.WorkList.filter((e=>e.project===t))},getWorkByIndex(t){try{const e=this.WorkList.find((e=>e.index===t)),r={...e};return r.detail=this.deIndexifyDetailWithType(r.type,r.detail),r.member=i.N.findMemberByIndex(r.member).name,r.master=i.N.findMemberByIndex(r.master).name,r}catch(e){console.log(e)}},getOriginalWorkByIndex(t){return this.WorkList.find((e=>e.index===t))},getAllWorkByProject(t){return this.WorkList.filter((e=>e.project===t))},finishWork(t,e,r){const a=this.getOriginalWorkByIndex(t);a.status="완료",a.desc=e,a.etc=r,void 0===this.getAllWorkByProject(a.project).find((t=>"완료"!==t.status))&&s.I.finishProject(a.project),this.refreshWorkList()},getWorkByMemberAndDetailAndProject(t,e,r){return this.WorkList.find((a=>a.member===t&&a.detail===e&&a.project===r))}})},2973:function(t,e,r){r.r(e),r.d(e,{default:function(){return c}});var a=r(3396);const i={class:"CenterButtons"};function s(t,e,r,s,n,l){const o=(0,a.up)("el-table-column"),d=(0,a.up)("el-option"),p=(0,a.up)("el-select"),c=(0,a.up)("el-table"),m=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{data:n.tableData},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{prop:"name",label:"이름"}),(0,a.Wm)(o,{prop:"department",label:"분야"}),(0,a.Wm)(o,{label:"업무"},{default:(0,a.w5)((t=>[(0,a.Wm)(p,{modelValue:t.row.detail,"onUpdate:modelValue":e=>t.row.detail=e},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.getDetailWork(t.row.department),(e=>((0,a.wg)(),(0,a.j4)(d,{key:e.value,label:e.label,value:e.value,modelValue:t.row.detail,"onUpdate:modelValue":e=>t.row.detail=e},null,8,["label","value","modelValue","onUpdate:modelValue"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),(0,a._)("div",i,[(0,a.Wm)(m,{type:"primary",onClick:l.saveEmit},{default:(0,a.w5)((()=>[(0,a.Uk)("저장")])),_:1},8,["onClick"]),(0,a.Wm)(m,{onClick:l.clear},{default:(0,a.w5)((()=>[(0,a.Uk)("취소")])),_:1},8,["onClick"])])],64)}r(560);var n=r(2760),l=r(167),o={name:"AllocateWork",emits:["saveWork"],data(){return{tableData:[]}},props:{member:{type:Array,default:()=>[]},parentData:{type:Array,default:()=>[]}},computed:{memberData(){const t=[];return this.member.forEach((e=>{t.push(l.N.findMemberByIndex(e))})),t},checkFull(){return this.tableData.every((t=>""!==t.detail))}},methods:{getDetailWork(t){return n.m.callDetailedWorkByParent(t)},dataInit(){this.memberData.forEach(((t,e)=>{this.tableData.push({name:t.name,department:t.department,detail:this.parentData?n.m.deIndexifyDetailWithMember(t,this.parentData[e]):""})}))},saveEmit(){if(this.checkFull){let t=[];this.tableData.forEach((e=>{t.push(n.m.indexifyDetail(e))})),this.$emit("saveWork",t)}else this.$message({message:"업무를 모두 배정해주세요",type:"warning"})},clear(){this.tableData=[],this.dataInit()}},mounted(){this.dataInit()}},d=r(89);const p=(0,d.Z)(o,[["render",s]]);var c=p}}]);
//# sourceMappingURL=973.92cae6fd.js.map