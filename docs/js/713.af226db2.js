"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[713,81],{4285:function(e,t,r){r.d(t,{v:function(){return o}});r(560);var s=r(4870),n=r(6797),a=r.n(n),i=r(167),l=r(8865);const o=(0,s.Um)({List:localStorage.getItem("messageList")?JSON.parse(localStorage.getItem("messageList")):[],refreshList(){localStorage.setItem("messageList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("messageList"))},template:{index:"",from:"",to:"",reference:"",title:"",content:"",update:a()().format("YYYY-MM-DD"),status:!0,read:!1},createMessage(e){if(e.to.length>1)return e.to.forEach((t=>{const r={index:this.List.length,from:i.N.currentMember,to:t,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:a()().format("YYYY-MM-DD"),status:!0,read:!1};l.j.createAlarm("messageSend",r.from,r.to),this.List.push(r)})),void this.refreshList();const t={index:this.List.length,from:i.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:a()().format("YYYY-MM-DD"),status:!0};this.List.push(t),l.j.createAlarm("messageSend",t.from,t.to),this.refreshList()},editMessage(e,t,r=!1){const s={index:this.List.length,from:i.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:a()().format("YYYY-MM-DD"),status:!0,read:!1};r&&(this.filterReplyMessageGroupReply(t).length>0?this.addReplyMessageGroup(t,s.index):this.createReplyMessageGroup(t,s.index)),this.List.push(s),l.j.createAlarm("messageSend",s.from,s.to),this.refreshList()},getAllList(){let e=[];return this.List.forEach((t=>{if(t.status){let r="";t.reference?t.reference.forEach((e=>{r+=i.N.findMemberByIndex(e).name+" ,"})):r=[],e.push({index:t.index,from:i.N.findMemberByIndex(t.from).name,to:i.N.findMemberByIndex(t.to).name,reference:r,title:t.title,content:t.content,update:t.update,status:t.status,read:t.read})}})),e},getMessage(e){const t=i.N.findMemberByIndex(e).name;return this.getAllList().filter((e=>e.to===t||e.reference.includes(t)))},findMessageByIndex(e){return this.getAllList().find((t=>t.index===e))},findOriginalMessageByIndex(e){return this.List.find((t=>t.index===e))},deleteMessage(e){const t=this.findMessageByIndex(e);t.status=!1,this.refreshList()},calculateMessageCountByMessage(e){const t=this.List.find((t=>t.index===e)),r=t.to,s=this.List.filter((e=>e.to===r)),n=s.find((t=>t.index===e));return`${s.indexOf(n)+1}/${s.length}`},referenceCheck(e){const t=this.List.find((t=>t.index===e));return t.to===i.N.currentMember},readMessage(e){const t=this.List.find((t=>t.index===e));t.read=!0,this.refreshList()},ReplyMessageGroup:localStorage.getItem("replyMessageGroup")?JSON.parse(localStorage.getItem("replyMessageGroup")):[],refreshGroup(){localStorage.setItem("replyMessageGroup",JSON.stringify(this.ReplyMessageGroup)),this.ReplyMessageGroup=JSON.parse(localStorage.getItem("replyMessageGroup"))},createReplyMessageGroup(e,t){const r={index:this.ReplyMessageGroup.length,originalMessage:e,replyMessage:[t],status:!0};this.ReplyMessageGroup.push(r),this.refreshGroup()},addReplyMessageGroup(e,t){let r=this.findGroupByOGIndex(e);void 0===r&&(r=this.filterReplyMessageGroupReply(e)[0]),r.replyMessage.push(t),this.refreshGroup()},findGroupByOGIndex(e){return this.ReplyMessageGroup.find((t=>t.originalMessage===e))},filterReplyMessageGroupReply(e){return this.ReplyMessageGroup.filter((t=>t.replyMessage.includes(e)))},getReplyChainArray(e){const t=[];if(this.findGroupByOGIndex(e)){const r=this.findGroupByOGIndex(e);return t.push(this.findOriginalMessageByIndex(r.originalMessage)),r.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))})),t}if(this.filterReplyMessageGroupReply(e).length>0){const r=this.filterReplyMessageGroupReply(e);return r.forEach((e=>{t.push(this.findOriginalMessageByIndex(e.originalMessage)),e.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))}))})),t}return t}})},2081:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var s=r(3396),n=r(7139);const a={class:"nameTab"};function i(e,t,r,i,l,o){const u=(0,s.up)("UserFilled"),d=(0,s.up)("el-icon"),c=(0,s.up)("el-avatar");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(c,{color:l.color,"background-color":l.color},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{color:l.color,size:l.size},{default:(0,s.w5)((()=>[(0,s.Wm)(u)])),_:1},8,["color","size"])])),_:1},8,["color","background-color"]),(0,s._)("span",a,(0,n.zw)(l.member.name)+"("+(0,n.zw)(l.member.department)+")",1)])}var l=r(2748),o=r(167),u={name:"userAvatar",components:{UserFilled:l.wvC},data(){return{size:"large",member:{},color:""}},props:{parentMember:{type:Number,default:2}},methods:{colorCheck(){switch(this.member.department){case"기획":return"#409EFF";case"개발":return"#67C23A";case"디자인":return"#E6A23C";case"기타":return"#F56C6C";default:return"#909399"}}},mounted(){this.member=o.N.findMemberByIndex(this.parentMember),this.color=this.colorCheck()}},d=r(89);const c=(0,d.Z)(u,[["render",i],["__scopeId","data-v-5cbeb6c0"]]);var p=c},9709:function(e,t,r){r.r(t),r.d(t,{default:function(){return M}});var s=r(3396),n=r(7139);const a={class:"messageTitle"},i={class:"bigSize"},l=["innerHTML"];function o(e,t,r,o,u,d){const c=(0,s.up)("el-button"),p=(0,s.up)("el-button-group"),f=(0,s.up)("el-col"),g=(0,s.up)("el-row"),m=(0,s.up)("userAvatar");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:8},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{type:"primary",onClick:d.returnToMain},{default:(0,s.w5)((()=>[(0,s.Uk)("목록")])),_:1},8,["onClick"]),(0,s.Wm)(c,{type:"primary",onClick:d.deleteMessage},{default:(0,s.w5)((()=>[(0,s.Uk)("삭제")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,s.Wm)(f,{span:4,offset:12},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(d.tempWhere),1)])),_:1})])),_:1})]),(0,s._)("div",a,(0,n.zw)(u.title),1),(0,s._)("div",null,[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:4},{default:(0,s.w5)((()=>[(0,s.Uk)("보낸 사람")])),_:1}),d.isReference?((0,s.wg)(),(0,s.j4)(f,{key:0,span:4},{default:(0,s.w5)((()=>[(0,s.Uk)("받는 사람")])),_:1})):(0,s.kq)("",!0)])),_:1}),d.isReference?((0,s.wg)(),(0,s.j4)(g,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:4},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{parentMember:d.originalFrom},null,8,["parentMember"])])),_:1}),(0,s.Wm)(f,{span:4},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{parentMember:d.originalTo},null,8,["parentMember"])])),_:1}),(0,s.Wm)(f,{span:4,offset:12},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(d.messageData.update),1)])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(g,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{span:4},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{parentMember:d.originalFrom},null,8,["parentMember"])])),_:1}),(0,s.Wm)(f,{span:4,offset:16},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(d.messageData.update),1)])),_:1})])),_:1}))]),(0,s._)("div",i,[(0,s._)("div",{innerHTML:u.content},null,8,l)]),(0,s._)("div",null,[(0,s.Wm)(c,{type:"primary",onClick:d.reply,size:"large"},{default:(0,s.w5)((()=>[(0,s.Uk)("답장")])),_:1},8,["onClick"]),(0,s.Wm)(c,{type:"primary",onClick:d.resend,size:"large"},{default:(0,s.w5)((()=>[(0,s.Uk)("전달")])),_:1},8,["onClick"])])])}var u=r(4285),d=r(6e3),c=r(7178),p=r(2081),f=r(167),g={name:"ShowMessage",components:{userAvatar:p["default"]},data(){return{title:"",content:null}},props:{parentIndex:{type:Number,required:!0}},computed:{messageData(){return u.v.findMessageByIndex(this.parentIndex)},originalFrom(){return u.v.findOriginalMessageByIndex(this.parentIndex).from},originalTo(){return u.v.findOriginalMessageByIndex(this.parentIndex).to},tempWhere(){return u.v.calculateMessageCountByMessage(this.parentIndex)},isReference(){return u.v.findOriginalMessageByIndex(this.parentIndex).to!==f.N.currentMember}},methods:{pageInit(){this.title=this.messageData.title,this.content=this.messageData.content},debug(){console.log(this.messageData),console.log(this.descriptionData)},reply(){this.$emit("reply")},resend(){this.$emit("resend")},deleteMessage(){d.T.confirm("삭제하시겠습니까?","경고",{confirmButtonText:"예",cancelButtonText:"아니오",type:"warning"}).then((()=>{(0,c.z8)({type:"info",message:"삭제되었습니다"}),this.$emit("deleteMessage")}))},returnToMain(){this.$emit("returnToMain")}},mounted(){this.pageInit()}},m=r(89);const h=(0,m.Z)(g,[["render",o],["__scopeId","data-v-4423cb52"]]);var M=h}}]);
//# sourceMappingURL=713.af226db2.js.map