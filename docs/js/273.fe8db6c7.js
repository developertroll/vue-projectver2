"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[273],{4285:function(e,t,r){r.d(t,{v:function(){return l}});r(560);var s=r(4870),a=r(6797),n=r.n(a),i=r(167),o=r(8865);const l=(0,s.Um)({List:localStorage.getItem("messageList")?JSON.parse(localStorage.getItem("messageList")):[],refreshList(){localStorage.setItem("messageList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("messageList"))},template:{index:"",from:"",to:"",reference:"",title:"",content:"",update:n()().format("YYYY-MM-DD"),status:!0,read:!1},createMessage(e){if(e.to.length>1)return e.to.forEach((t=>{const r={index:this.List.length,from:i.N.currentMember,to:t,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:n()().format("YYYY-MM-DD"),status:!0,read:!1};o.j.createAlarm("messageSend",r.from,r.to),this.List.push(r)})),void this.refreshList();const t={index:this.List.length,from:i.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:n()().format("YYYY-MM-DD"),status:!0};this.List.push(t),o.j.createAlarm("messageSend",t.from,t.to),this.refreshList()},editMessage(e,t,r=!1){const s={index:this.List.length,from:i.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:n()().format("YYYY-MM-DD"),status:!0,read:!1};r&&(this.filterReplyMessageGroupReply(t).length>0?this.addReplyMessageGroup(t,s.index):this.createReplyMessageGroup(t,s.index)),this.List.push(s),o.j.createAlarm("messageSend",s.from,s.to),this.refreshList()},getAllList(){let e=[];return this.List.forEach((t=>{if(t.status){let r="";t.reference?t.reference.forEach((e=>{r+=i.N.findMemberByIndex(e).name+" ,"})):r=[],e.push({index:t.index,from:i.N.findMemberByIndex(t.from).name,to:i.N.findMemberByIndex(t.to).name,reference:r,title:t.title,content:t.content,update:t.update,status:t.status,read:t.read})}})),e},getMessage(e){const t=i.N.findMemberByIndex(e).name;return this.getAllList().filter((e=>e.to===t||e.reference.includes(t)))},findMessageByIndex(e){return this.getAllList().find((t=>t.index===e))},findOriginalMessageByIndex(e){return this.List.find((t=>t.index===e))},deleteMessage(e){const t=this.findMessageByIndex(e);t.status=!1,this.refreshList()},calculateMessageCountByMessage(e){const t=this.List.find((t=>t.index===e)),r=t.to,s=this.List.filter((e=>e.to===r)),a=s.find((t=>t.index===e));return`${s.indexOf(a)+1}/${s.length}`},referenceCheck(e){const t=this.List.find((t=>t.index===e));return t.to===i.N.currentMember},readMessage(e){const t=this.List.find((t=>t.index===e));t.read=!0,this.refreshList()},ReplyMessageGroup:localStorage.getItem("replyMessageGroup")?JSON.parse(localStorage.getItem("replyMessageGroup")):[],refreshGroup(){localStorage.setItem("replyMessageGroup",JSON.stringify(this.ReplyMessageGroup)),this.ReplyMessageGroup=JSON.parse(localStorage.getItem("replyMessageGroup"))},createReplyMessageGroup(e,t){const r={index:this.ReplyMessageGroup.length,originalMessage:e,replyMessage:[t],status:!0};this.ReplyMessageGroup.push(r),this.refreshGroup()},addReplyMessageGroup(e,t){let r=this.findGroupByOGIndex(e);void 0===r&&(r=this.filterReplyMessageGroupReply(e)[0]),r.replyMessage.push(t),this.refreshGroup()},findGroupByOGIndex(e){return this.ReplyMessageGroup.find((t=>t.originalMessage===e))},filterReplyMessageGroupReply(e){return this.ReplyMessageGroup.filter((t=>t.replyMessage.includes(e)))},getReplyChainArray(e){const t=[];if(this.findGroupByOGIndex(e)){const r=this.findGroupByOGIndex(e);return t.push(this.findOriginalMessageByIndex(r.originalMessage)),r.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))})),t}if(this.filterReplyMessageGroupReply(e).length>0){const r=this.filterReplyMessageGroupReply(e);return r.forEach((e=>{t.push(this.findOriginalMessageByIndex(e.originalMessage)),e.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))}))})),t}return t}})},6273:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var s=r(3396),a=r(7139);const n={class:"CenterButtons"};function i(e,t,r,i,o,l){const u=(0,s.up)("el-table-column"),d=(0,s.up)("el-tag"),c=(0,s.up)("el-table"),p=(0,s.up)("el-pagination");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(c,{data:o.currentTableData,onCurrentChange:l.handleCurrentChange,"default-sort":{prop:"index",order:"descending"},"row-class-name":l.readRow},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{prop:"index",label:"번호",sortable:"",width:"150"}),(0,s.Wm)(u,{prop:"type",label:"종류",width:"150"},{default:(0,s.w5)((e=>[(0,s.Wm)(d,{type:"중요"===e.row.type?"success":"info"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.row.type),1)])),_:2},1032,["type"])])),_:1}),(0,s.Wm)(u,{prop:"title",label:"제목"}),(0,s.Wm)(u,{prop:"update",label:"날짜",sortable:""})])),_:1},8,["data","onCurrentChange","row-class-name"]),(0,s._)("div",n,[(0,s.Wm)(p,{modelValue:o.currentPage,"onUpdate:modelValue":t[0]||(t[0]=e=>o.currentPage=e),layout:"prev, pager, next",total:l.totalPage,"page-size":15},null,8,["modelValue","total"])])])}r(560);var o=r(4285),l=r(167),u={name:"MessageTable",data(){return{CurrentMember:l.N.currentMember,CurrentMemberName:l.N.getCurrentMemberName(),tableData:[],currentRow:null,currentPage:1,currentTableData:[]}},props:{parentType:{type:String,default:null}},computed:{MessageData(){return o.v.getAllList()},totalPage(){return this.MessageData.length}},methods:{tableInit(){this.MessageData.forEach((e=>{let t="";if(this.parentType)switch(this.parentType){case"to":if(e.to!==this.CurrentMemberName)return;t=o.v.referenceCheck(e.index)?"중요":"참조";break;case"from":if(e.from!==this.CurrentMemberName)return;t="보냄";break;case"reference":if(-1===e.reference.indexOf(this.CurrentMemberName))return;t="참조";break;case"read":if(!e.read&&e.to!==this.CurrentMemberName)return;t=o.v.referenceCheck(e.index)?"중요":"참조";break;case"unread":if(e.read&&e.to!==this.CurrentMemberName)return;t=o.v.referenceCheck(e.index)?"중요":"참조";break;default:if(e.to!==this.CurrentMemberName)return;break}else{if(e.to!==this.CurrentMemberName)return;t=o.v.referenceCheck(e.index)?"중요":"참조"}this.tableData.push({referenceIndex:e.index,type:t,index:this.tableData.length+1,title:e.title,update:e.update,read:e.read})})),this.currentTableData=this.tableData.slice(15*(this.currentPage-1),15*this.currentPage)},handleCurrentChange(e){this.currentRow=e,o.v.readMessage(this.currentRow.referenceIndex),this.$emit("readMessage",this.currentRow.referenceIndex,this.currentRow.index)},readRow({row:e}){return e.read?"중요"===e.type?"success-row":"info-row":"중요"===e.type?"success-row bold":"info-row bold"}},mounted(){this.tableInit()}},d=r(89);const c=(0,d.Z)(u,[["render",i]]);var p=c}}]);
//# sourceMappingURL=273.fe8db6c7.js.map