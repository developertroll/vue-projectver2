"use strict";(self["webpackChunkvue_projectver2"]=self["webpackChunkvue_projectver2"]||[]).push([[592,81],{4285:function(e,t,r){r.d(t,{v:function(){return l}});r(560);var s=r(4870),n=r(6797),i=r.n(n),a=r(167),o=r(8865);const l=(0,s.Um)({List:localStorage.getItem("messageList")?JSON.parse(localStorage.getItem("messageList")):[],refreshList(){localStorage.setItem("messageList",JSON.stringify(this.List)),this.List=JSON.parse(localStorage.getItem("messageList"))},template:{index:"",from:"",to:"",reference:"",title:"",content:"",update:i()().format("YYYY-MM-DD"),status:!0,read:!1},createMessage(e){if(e.to.length>1)return e.to.forEach((t=>{const r={index:this.List.length,from:a.N.currentMember,to:t,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:i()().format("YYYY-MM-DD"),status:!0,read:!1};o.j.createAlarm("messageSend",r.from,r.to),this.List.push(r)})),void this.refreshList();const t={index:this.List.length,from:a.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:i()().format("YYYY-MM-DD"),status:!0};this.List.push(t),o.j.createAlarm("messageSend",t.from,t.to),this.refreshList()},editMessage(e,t,r=!1){const s={index:this.List.length,from:a.N.currentMember,to:e.to,reference:""===e.reference?[]:Array.isArray(e.reference)?e.reference:[e.reference],title:e.title,content:e.content,update:i()().format("YYYY-MM-DD"),status:!0,read:!1};r&&(this.filterReplyMessageGroupReply(t).length>0?this.addReplyMessageGroup(t,s.index):this.createReplyMessageGroup(t,s.index)),this.List.push(s),o.j.createAlarm("messageSend",s.from,s.to),this.refreshList()},getAllList(){let e=[];return this.List.forEach((t=>{if(t.status){let r="";t.reference?t.reference.forEach((e=>{r+=a.N.findMemberByIndex(e).name+" ,"})):r=[],e.push({index:t.index,from:a.N.findMemberByIndex(t.from).name,to:a.N.findMemberByIndex(t.to).name,reference:r,title:t.title,content:t.content,update:t.update,status:t.status,read:t.read})}})),e},getMessage(e){const t=a.N.findMemberByIndex(e).name;return this.getAllList().filter((e=>e.to===t||e.reference.includes(t)))},findMessageByIndex(e){return this.getAllList().find((t=>t.index===e))},findOriginalMessageByIndex(e){return this.List.find((t=>t.index===e))},deleteMessage(e){const t=this.findMessageByIndex(e);t.status=!1,this.refreshList()},calculateMessageCountByMessage(e){const t=this.List.find((t=>t.index===e)),r=t.to,s=this.List.filter((e=>e.to===r)),n=s.find((t=>t.index===e));return`${s.indexOf(n)+1}/${s.length}`},referenceCheck(e){const t=this.List.find((t=>t.index===e));return t.to===a.N.currentMember},readMessage(e){const t=this.List.find((t=>t.index===e));t.read=!0,this.refreshList()},ReplyMessageGroup:localStorage.getItem("replyMessageGroup")?JSON.parse(localStorage.getItem("replyMessageGroup")):[],refreshGroup(){localStorage.setItem("replyMessageGroup",JSON.stringify(this.ReplyMessageGroup)),this.ReplyMessageGroup=JSON.parse(localStorage.getItem("replyMessageGroup"))},createReplyMessageGroup(e,t){const r={index:this.ReplyMessageGroup.length,originalMessage:e,replyMessage:[t],status:!0};this.ReplyMessageGroup.push(r),this.refreshGroup()},addReplyMessageGroup(e,t){let r=this.findGroupByOGIndex(e);void 0===r&&(r=this.filterReplyMessageGroupReply(e)[0]),r.replyMessage.push(t),this.refreshGroup()},findGroupByOGIndex(e){return this.ReplyMessageGroup.find((t=>t.originalMessage===e))},filterReplyMessageGroupReply(e){return this.ReplyMessageGroup.filter((t=>t.replyMessage.includes(e)))},getReplyChainArray(e){const t=[];if(this.findGroupByOGIndex(e)){const r=this.findGroupByOGIndex(e);return t.push(this.findOriginalMessageByIndex(r.originalMessage)),r.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))})),t}if(this.filterReplyMessageGroupReply(e).length>0){const r=this.filterReplyMessageGroupReply(e);return r.forEach((e=>{t.push(this.findOriginalMessageByIndex(e.originalMessage)),e.replyMessage.forEach((e=>{t.push(this.findOriginalMessageByIndex(e))}))})),t}return t}})},2081:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var s=r(3396),n=r(7139);const i={class:"nameTab"};function a(e,t,r,a,o,l){const u=(0,s.up)("UserFilled"),c=(0,s.up)("el-icon"),d=(0,s.up)("el-avatar");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(d,{color:o.color,"background-color":o.color},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{color:o.color,size:o.size},{default:(0,s.w5)((()=>[(0,s.Wm)(u)])),_:1},8,["color","size"])])),_:1},8,["color","background-color"]),(0,s._)("span",i,(0,n.zw)(o.member.name)+"("+(0,n.zw)(o.member.department)+")",1)])}var o=r(2748),l=r(167),u={name:"userAvatar",components:{UserFilled:o.wvC},data(){return{size:"large",member:{},color:""}},props:{parentMember:{type:Number,default:2}},methods:{colorCheck(){switch(this.member.department){case"기획":return"#409EFF";case"개발":return"#67C23A";case"디자인":return"#E6A23C";case"기타":return"#F56C6C";default:return"#909399"}}},mounted(){this.member=l.N.findMemberByIndex(this.parentMember),this.color=this.colorCheck()}},c=r(89);const d=(0,c.Z)(u,[["render",a],["__scopeId","data-v-5cbeb6c0"]]);var p=d},9592:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var s=r(3396),n=r(7139);const i=["innerHTML"];function a(e,t,r,a,o,l){const u=(0,s.up)("el-button"),c=(0,s.up)("el-col"),d=(0,s.up)("el-row"),p=(0,s.up)("el-divider"),h=(0,s.up)("userAvatar");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{span:8},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{type:"primary",onClick:l.returnToMain},{default:(0,s.w5)((()=>[(0,s.Uk)("목록")])),_:1},8,["onClick"])])),_:1}),(0,s.Wm)(c,{span:4,offset:12},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(l.tempWhere),1)])),_:1})])),_:1})]),(0,s.Wm)(p),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.entireChain,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.index},[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{span:4},{default:(0,s.w5)((()=>[o.entireChain.length>0?((0,s.wg)(),(0,s.j4)(h,{key:0,parentMember:e.from},null,8,["parentMember"])):(0,s.kq)("",!0)])),_:2},1024),(0,s.Wm)(c,{span:4,offset:16},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.update),1)])),_:2},1024)])),_:2},1024),(0,s.Wm)(p),(0,s._)("div",{innerHTML:l.cutContent(e.content)},null,8,i),(0,s.Wm)(p)])))),128)),(0,s._)("div",null,[l.lastWhoCheck()?((0,s.wg)(),(0,s.j4)(u,{key:0,type:"primary",onClick:l.reply,size:"large"},{default:(0,s.w5)((()=>[(0,s.Uk)("답장")])),_:1},8,["onClick"])):(0,s.kq)("",!0),(0,s.Wm)(u,{type:"primary",onClick:l.resend,size:"large"},{default:(0,s.w5)((()=>[(0,s.Uk)("전달")])),_:1},8,["onClick"])])])}var o=r(4285),l=r(6e3),u=r(7178),c=r(2081),d=r(167),p={name:"ShowMessage",components:{userAvatar:c["default"]},data(){return{entireChain:[],currentMember:d.N.currentMember}},props:{parentIndex:{type:Number,required:!0}},computed:{messageData(){return o.v.getReplyChainArray(this.parentIndex)},tempWhere(){return o.v.calculateMessageCountByMessage(this.parentIndex)},OG(){return o.v.findOriginalMessageByIndex(this.parentIndex)}},methods:{pageInit(){this.entireChain=this.messageData},debug(){console.log(this.messageData),console.log(this.descriptionData)},reply(){this.$emit("reply")},resend(){this.$emit("resend")},deleteMessage(){l.T.confirm("삭제하시겠습니까?","경고",{confirmButtonText:"예",cancelButtonText:"아니오",type:"warning"}).then((()=>{(0,u.z8)({type:"info",message:"삭제되었습니다"}),this.$emit("deleteMessage")}))},returnToMain(){this.$emit("returnToMain")},cutContent(e){let t=e,r=t.indexOf("<p>=========");return-1!==r&&(t=t.substring(0,r)),t},checkWho(e){return Number(o.v.findOriginalMessageByIndex(e).from)},lastWhoCheck(){return this.entireChain.length>0&&this.entireChain[this.entireChain.length-1].from!==this.currentMember}},mounted(){this.pageInit()}},h=r(89);const f=(0,h.Z)(p,[["render",a],["__scopeId","data-v-3e491f8e"]]);var g=f}}]);
//# sourceMappingURL=592.d1e26a78.js.map